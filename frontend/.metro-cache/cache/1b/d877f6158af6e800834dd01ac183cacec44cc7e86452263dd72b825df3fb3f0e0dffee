{"dependencies":[{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"expo-device","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":38,"index":91}}],"key":"bBpmAhO1g++sdeUzQmFVGoQIVwg=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":133},"end":{"line":4,"column":69,"index":202}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":203},"end":{"line":5,"column":26,"index":229}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.registerForPushNotifications = registerForPushNotifications;\n  exports.registerTokenWithServer = registerTokenWithServer;\n  exports.setupPushNotifications = setupPushNotifications;\n  var _expoNotifications = require(_dependencyMap[0], \"expo-notifications\");\n  var Notifications = _interopNamespace(_expoNotifications);\n  var _expoDevice = require(_dependencyMap[1], \"expo-device\");\n  var Device = _interopNamespace(_expoDevice);\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[2], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[4], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n\n  /**\n   * Request notification permissions and get Expo push token\n   */\n  async function registerForPushNotifications() {\n    try {\n      // Check if we're on a physical device\n      if (!Device.isDevice) {\n        console.log('Push notifications require a physical device');\n        return null;\n      }\n\n      // Check existing permissions\n      const {\n        status: existingStatus\n      } = await Notifications.getPermissionsAsync();\n      let finalStatus = existingStatus;\n\n      // Request permissions if not already granted\n      if (existingStatus !== 'granted') {\n        const {\n          status\n        } = await Notifications.requestPermissionsAsync();\n        finalStatus = status;\n      }\n      if (finalStatus !== 'granted') {\n        console.log('Failed to get push notification permission');\n        return null;\n      }\n\n      // Get Expo push token\n      const tokenData = await Notifications.getExpoPushTokenAsync();\n      const token = tokenData.data;\n      console.log('Expo Push Token:', token);\n\n      // Configure Android notification channel\n      if (Platform.default.OS === 'android') {\n        await Notifications.setNotificationChannelAsync('default', {\n          name: 'SafeGuard Alerts',\n          importance: Notifications.AndroidImportance.MAX,\n          vibrationPattern: [0, 250, 250, 250],\n          lightColor: '#EF4444',\n          sound: 'default'\n        });\n        await Notifications.setNotificationChannelAsync('emergency', {\n          name: 'Emergency Alerts',\n          importance: Notifications.AndroidImportance.MAX,\n          vibrationPattern: [0, 500, 250, 500],\n          lightColor: '#FF0000',\n          sound: 'default',\n          bypassDnd: true\n        });\n      }\n      return token;\n    } catch (error) {\n      console.error('Error registering for push notifications:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Register push token with backend server\n   */\n  async function registerTokenWithServer(token) {\n    try {\n      const authToken = await AsyncStorage.default.getItem('auth_token');\n      if (!authToken) {\n        console.log('No auth token available to register push token');\n        return false;\n      }\n      await axios.default.post(`${BACKEND_URL}/api/push-token/register`, token, {\n        headers: {\n          Authorization: `Bearer ${authToken}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      await AsyncStorage.default.setItem('push_token', token);\n      console.log('Push token registered with server successfully');\n      return true;\n    } catch (error) {\n      console.error('Failed to register push token with server:', error.response?.data || error.message);\n      return false;\n    }\n  }\n\n  /**\n   * Full push notification setup - call after login\n   */\n  async function setupPushNotifications() {\n    const token = await registerForPushNotifications();\n    if (token) {\n      return await registerTokenWithServer(token);\n    }\n    return false;\n  }\n});","lineCount":136,"map":[[27,2,12,0,"exports"],[27,9,12,0],[27,10,12,0,"registerForPushNotifications"],[27,38,12,0],[27,41,12,0,"registerForPushNotifications"],[27,69,12,0],[28,2,71,0,"exports"],[28,9,71,0],[28,10,71,0,"registerTokenWithServer"],[28,33,71,0],[28,36,71,0,"registerTokenWithServer"],[28,59,71,0],[29,2,102,0,"exports"],[29,9,102,0],[29,10,102,0,"setupPushNotifications"],[29,32,102,0],[29,35,102,0,"setupPushNotifications"],[29,57,102,0],[30,2,1,0],[30,6,1,0,"_expoNotifications"],[30,24,1,0],[30,27,1,0,"require"],[30,34,1,0],[30,35,1,0,"_dependencyMap"],[30,49,1,0],[31,2,1,0],[31,6,1,0,"Notifications"],[31,19,1,0],[31,22,1,0,"_interopNamespace"],[31,39,1,0],[31,40,1,0,"_expoNotifications"],[31,58,1,0],[32,2,2,0],[32,6,2,0,"_expoDevice"],[32,17,2,0],[32,20,2,0,"require"],[32,27,2,0],[32,28,2,0,"_dependencyMap"],[32,42,2,0],[33,2,2,0],[33,6,2,0,"Device"],[33,12,2,0],[33,15,2,0,"_interopNamespace"],[33,32,2,0],[33,33,2,0,"_expoDevice"],[33,44,2,0],[34,2,2,38],[34,6,2,38,"_reactNativeWebDistExportsPlatform"],[34,40,2,38],[34,43,2,38,"require"],[34,50,2,38],[34,51,2,38,"_dependencyMap"],[34,65,2,38],[35,2,2,38],[35,6,2,38,"Platform"],[35,14,2,38],[35,17,2,38,"_interopDefault"],[35,32,2,38],[35,33,2,38,"_reactNativeWebDistExportsPlatform"],[35,67,2,38],[36,2,4,0],[36,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[36,42,4,0],[36,45,4,0,"require"],[36,52,4,0],[36,53,4,0,"_dependencyMap"],[36,67,4,0],[37,2,4,0],[37,6,4,0,"AsyncStorage"],[37,18,4,0],[37,21,4,0,"_interopDefault"],[37,36,4,0],[37,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[37,73,4,0],[38,2,5,0],[38,6,5,0,"_axios"],[38,12,5,0],[38,15,5,0,"require"],[38,22,5,0],[38,23,5,0,"_dependencyMap"],[38,37,5,0],[39,2,5,0],[39,6,5,0,"axios"],[39,11,5,0],[39,14,5,0,"_interopDefault"],[39,29,5,0],[39,30,5,0,"_axios"],[39,36,5,0],[40,2,7,0],[40,8,7,6,"BACKEND_URL"],[40,19,7,17],[40,22,7,20,"process"],[40,29,7,27],[40,30,7,28,"env"],[40,33,7,31],[40,34,7,32,"EXPO_PUBLIC_BACKEND_URL"],[40,57,7,55],[42,2,9,0],[43,0,10,0],[44,0,11,0],[45,2,12,7],[45,17,12,22,"registerForPushNotifications"],[45,45,12,50,"registerForPushNotifications"],[45,46,12,50],[45,48,12,77],[46,4,13,2],[46,8,13,6],[47,6,14,4],[48,6,15,4],[48,10,15,8],[48,11,15,9,"Device"],[48,17,15,15],[48,18,15,16,"isDevice"],[48,26,15,24],[48,28,15,26],[49,8,16,6,"console"],[49,15,16,13],[49,16,16,14,"log"],[49,19,16,17],[49,20,16,18],[49,66,16,64],[49,67,16,65],[50,8,17,6],[50,15,17,13],[50,19,17,17],[51,6,18,4],[53,6,20,4],[54,6,21,4],[54,12,21,10],[55,8,21,12,"status"],[55,14,21,18],[55,16,21,20,"existingStatus"],[56,6,21,35],[56,7,21,36],[56,10,21,39],[56,16,21,45,"Notifications"],[56,29,21,58],[56,30,21,59,"getPermissionsAsync"],[56,49,21,78],[56,50,21,79],[56,51,21,80],[57,6,22,4],[57,10,22,8,"finalStatus"],[57,21,22,19],[57,24,22,22,"existingStatus"],[57,38,22,36],[59,6,24,4],[60,6,25,4],[60,10,25,8,"existingStatus"],[60,24,25,22],[60,29,25,27],[60,38,25,36],[60,40,25,38],[61,8,26,6],[61,14,26,12],[62,10,26,14,"status"],[63,8,26,21],[63,9,26,22],[63,12,26,25],[63,18,26,31,"Notifications"],[63,31,26,44],[63,32,26,45,"requestPermissionsAsync"],[63,55,26,68],[63,56,26,69],[63,57,26,70],[64,8,27,6,"finalStatus"],[64,19,27,17],[64,22,27,20,"status"],[64,28,27,26],[65,6,28,4],[66,6,30,4],[66,10,30,8,"finalStatus"],[66,21,30,19],[66,26,30,24],[66,35,30,33],[66,37,30,35],[67,8,31,6,"console"],[67,15,31,13],[67,16,31,14,"log"],[67,19,31,17],[67,20,31,18],[67,64,31,62],[67,65,31,63],[68,8,32,6],[68,15,32,13],[68,19,32,17],[69,6,33,4],[71,6,35,4],[72,6,36,4],[72,12,36,10,"tokenData"],[72,21,36,19],[72,24,36,22],[72,30,36,28,"Notifications"],[72,43,36,41],[72,44,36,42,"getExpoPushTokenAsync"],[72,65,36,63],[72,66,36,64],[72,67,36,65],[73,6,38,4],[73,12,38,10,"token"],[73,17,38,15],[73,20,38,18,"tokenData"],[73,29,38,27],[73,30,38,28,"data"],[73,34,38,32],[74,6,39,4,"console"],[74,13,39,11],[74,14,39,12,"log"],[74,17,39,15],[74,18,39,16],[74,36,39,34],[74,38,39,36,"token"],[74,43,39,41],[74,44,39,42],[76,6,41,4],[77,6,42,4],[77,10,42,8,"Platform"],[77,18,42,16],[77,19,42,16,"default"],[77,26,42,16],[77,27,42,17,"OS"],[77,29,42,19],[77,34,42,24],[77,43,42,33],[77,45,42,35],[78,8,43,6],[78,14,43,12,"Notifications"],[78,27,43,25],[78,28,43,26,"setNotificationChannelAsync"],[78,55,43,53],[78,56,43,54],[78,65,43,63],[78,67,43,65],[79,10,44,8,"name"],[79,14,44,12],[79,16,44,14],[79,34,44,32],[80,10,45,8,"importance"],[80,20,45,18],[80,22,45,20,"Notifications"],[80,35,45,33],[80,36,45,34,"AndroidImportance"],[80,53,45,51],[80,54,45,52,"MAX"],[80,57,45,55],[81,10,46,8,"vibrationPattern"],[81,26,46,24],[81,28,46,26],[81,29,46,27],[81,30,46,28],[81,32,46,30],[81,35,46,33],[81,37,46,35],[81,40,46,38],[81,42,46,40],[81,45,46,43],[81,46,46,44],[82,10,47,8,"lightColor"],[82,20,47,18],[82,22,47,20],[82,31,47,29],[83,10,48,8,"sound"],[83,15,48,13],[83,17,48,15],[84,8,49,6],[84,9,49,7],[84,10,49,8],[85,8,51,6],[85,14,51,12,"Notifications"],[85,27,51,25],[85,28,51,26,"setNotificationChannelAsync"],[85,55,51,53],[85,56,51,54],[85,67,51,65],[85,69,51,67],[86,10,52,8,"name"],[86,14,52,12],[86,16,52,14],[86,34,52,32],[87,10,53,8,"importance"],[87,20,53,18],[87,22,53,20,"Notifications"],[87,35,53,33],[87,36,53,34,"AndroidImportance"],[87,53,53,51],[87,54,53,52,"MAX"],[87,57,53,55],[88,10,54,8,"vibrationPattern"],[88,26,54,24],[88,28,54,26],[88,29,54,27],[88,30,54,28],[88,32,54,30],[88,35,54,33],[88,37,54,35],[88,40,54,38],[88,42,54,40],[88,45,54,43],[88,46,54,44],[89,10,55,8,"lightColor"],[89,20,55,18],[89,22,55,20],[89,31,55,29],[90,10,56,8,"sound"],[90,15,56,13],[90,17,56,15],[90,26,56,24],[91,10,57,8,"bypassDnd"],[91,19,57,17],[91,21,57,19],[92,8,58,6],[92,9,58,7],[92,10,58,8],[93,6,59,4],[94,6,61,4],[94,13,61,11,"token"],[94,18,61,16],[95,4,62,2],[95,5,62,3],[95,6,62,4],[95,13,62,11,"error"],[95,18,62,16],[95,20,62,18],[96,6,63,4,"console"],[96,13,63,11],[96,14,63,12,"error"],[96,19,63,17],[96,20,63,18],[96,63,63,61],[96,65,63,63,"error"],[96,70,63,68],[96,71,63,69],[97,6,64,4],[97,13,64,11],[97,17,64,15],[98,4,65,2],[99,2,66,0],[101,2,68,0],[102,0,69,0],[103,0,70,0],[104,2,71,7],[104,17,71,22,"registerTokenWithServer"],[104,40,71,45,"registerTokenWithServer"],[104,41,71,46,"token"],[104,46,71,59],[104,48,71,79],[105,4,72,2],[105,8,72,6],[106,6,73,4],[106,12,73,10,"authToken"],[106,21,73,19],[106,24,73,22],[106,30,73,28,"AsyncStorage"],[106,42,73,40],[106,43,73,40,"default"],[106,50,73,40],[106,51,73,41,"getItem"],[106,58,73,48],[106,59,73,49],[106,71,73,61],[106,72,73,62],[107,6,74,4],[107,10,74,8],[107,11,74,9,"authToken"],[107,20,74,18],[107,22,74,20],[108,8,75,6,"console"],[108,15,75,13],[108,16,75,14,"log"],[108,19,75,17],[108,20,75,18],[108,68,75,66],[108,69,75,67],[109,8,76,6],[109,15,76,13],[109,20,76,18],[110,6,77,4],[111,6,79,4],[111,12,79,10,"axios"],[111,17,79,15],[111,18,79,15,"default"],[111,25,79,15],[111,26,79,16,"post"],[111,30,79,20],[111,31,80,6],[111,34,80,9,"BACKEND_URL"],[111,45,80,20],[111,71,80,46],[111,73,81,6,"token"],[111,78,81,11],[111,80,82,6],[112,8,83,8,"headers"],[112,15,83,15],[112,17,83,17],[113,10,84,10,"Authorization"],[113,23,84,23],[113,25,84,25],[113,35,84,35,"authToken"],[113,44,84,44],[113,46,84,46],[114,10,85,10],[114,24,85,24],[114,26,85,26],[115,8,86,8],[116,6,87,6],[116,7,88,4],[116,8,88,5],[117,6,90,4],[117,12,90,10,"AsyncStorage"],[117,24,90,22],[117,25,90,22,"default"],[117,32,90,22],[117,33,90,23,"setItem"],[117,40,90,30],[117,41,90,31],[117,53,90,43],[117,55,90,45,"token"],[117,60,90,50],[117,61,90,51],[118,6,91,4,"console"],[118,13,91,11],[118,14,91,12,"log"],[118,17,91,15],[118,18,91,16],[118,66,91,64],[118,67,91,65],[119,6,92,4],[119,13,92,11],[119,17,92,15],[120,4,93,2],[120,5,93,3],[120,6,93,4],[120,13,93,11,"error"],[120,18,93,21],[120,20,93,23],[121,6,94,4,"console"],[121,13,94,11],[121,14,94,12,"error"],[121,19,94,17],[121,20,94,18],[121,64,94,62],[121,66,94,64,"error"],[121,71,94,69],[121,72,94,70,"response"],[121,80,94,78],[121,82,94,80,"data"],[121,86,94,84],[121,90,94,88,"error"],[121,95,94,93],[121,96,94,94,"message"],[121,103,94,101],[121,104,94,102],[122,6,95,4],[122,13,95,11],[122,18,95,16],[123,4,96,2],[124,2,97,0],[126,2,99,0],[127,0,100,0],[128,0,101,0],[129,2,102,7],[129,17,102,22,"setupPushNotifications"],[129,39,102,44,"setupPushNotifications"],[129,40,102,44],[129,42,102,65],[130,4,103,2],[130,10,103,8,"token"],[130,15,103,13],[130,18,103,16],[130,24,103,22,"registerForPushNotifications"],[130,52,103,50],[130,53,103,51],[130,54,103,52],[131,4,105,2],[131,8,105,6,"token"],[131,13,105,11],[131,15,105,13],[132,6,106,4],[132,13,106,11],[132,19,106,17,"registerTokenWithServer"],[132,42,106,40],[132,43,106,41,"token"],[132,48,106,46],[132,49,106,47],[133,4,107,2],[134,4,109,2],[134,11,109,9],[134,16,109,14],[135,2,110,0],[136,0,110,1],[136,3]],"functionMap":{"names":["<global>","registerForPushNotifications","registerTokenWithServer","setupPushNotifications"],"mappings":"AAA;OCW;CDsD;OEK;CF0B;OGK;CHQ"},"hasCjsExports":false},"type":"js/module"}]}